{
  "version": "1.0",
  "description": "Pentest configuration for vulnerability type goals",
  "vulnerability_types": {
    "unauthorized": {
      "name": "未授权访问",
      "enabled": true,
      "goal": "identify",
      "goals": {
        "identify": {
          "description": "识别到未授权漏洞即可",
          "stop_after": [
            "tc_recon_unauth_001"
          ],
          "success_criteria": [
            "工具检测到未授权漏洞"
          ],
          "evidence_required": 1
        },
        "exploit": {
          "description": "成功利用未授权漏洞",
          "stop_after": [
            "tc_exploit_002"
          ],
          "success_criteria": [
            "成功通过未授权访问读取敏感信息或执行操作"
          ],
          "evidence_required": 1
        },
        "verify": {
          "description": "验证未授权访问的影响范围",
          "stop_after": [
            "tc_verify_003"
          ],
          "success_criteria": [
            "验证可访问的资源范围",
            "确认敏感数据可读取"
          ],
          "evidence_required": 2
        }
      }
    },
    "rce": {
      "name": "远程代码执行",
      "enabled": true,
      "goal": "exploit",
      "goals": {
        "identify": {
          "description": "识别到RCE漏洞即可",
          "stop_after": [
            "tc_recon_vuln_001"
          ],
          "success_criteria": [
            "找到RCE相关CVE"
          ],
          "evidence_required": 1
        },
        "exploit": {
          "description": "成功执行任意命令",
          "stop_after": [
            "tc_exploit_002"
          ],
          "success_criteria": [
            "执行id命令成功"
          ],
          "evidence_required": 1
        },
        "verify": {
          "description": "验证RCE的完整能力",
          "stop_after": [
            "tc_verify_003"
          ],
          "success_criteria": [
            "执行多个命令",
            "读取系统文件",
            "获取系统信息"
          ],
          "evidence_required": 3
        }
      }
    },
    "sqli": {
      "name": "SQL注入",
      "enabled": true,
      "goal": "verify",
      "goals": {
        "identify": {
          "description": "识别到SQL注入点",
          "stop_after": [
            "tc_sqli_detect_001"
          ],
          "success_criteria": [
            "发现SQL注入漏洞点"
          ],
          "evidence_required": 1
        },
        "exploit": {
          "description": "成功提取数据库信息",
          "stop_after": [
            "tc_sqli_exploit_002"
          ],
          "success_criteria": [
            "获取数据库版本或表名"
          ],
          "evidence_required": 1
        },
        "verify": {
          "description": "完整利用SQL注入",
          "stop_after": [
            "tc_sqli_verify_003"
          ],
          "success_criteria": [
            "dump数据库内容",
            "获取管理员密码"
          ],
          "evidence_required": 2
        }
      }
    },
    "file_upload": {
      "name": "文件上传",
      "enabled": true,
      "goal": "exploit",
      "goals": {
        "identify": {
          "description": "发现文件上传功能",
          "stop_after": [
            "tc_upload_detect_001"
          ],
          "success_criteria": [
            "找到文件上传点"
          ],
          "evidence_required": 1
        },
        "exploit": {
          "description": "成功上传webshell",
          "stop_after": [
            "tc_upload_exploit_002"
          ],
          "success_criteria": [
            "成功上传并访问webshell"
          ],
          "evidence_required": 1
        },
        "verify": {
          "description": "验证webshell功能",
          "stop_after": [
            "tc_upload_verify_003"
          ],
          "success_criteria": [
            "通过webshell执行命令",
            "读取系统文件"
          ],
          "evidence_required": 2
        }
      }
    },
    "xxe": {
      "name": "XML外部实体注入",
      "enabled": true,
      "goal": "identify",
      "goals": {
        "identify": {
          "description": "识别到XXE漏洞",
          "stop_after": [
            "tc_xxe_detect_001"
          ],
          "success_criteria": [
            "发现XXE漏洞点"
          ],
          "evidence_required": 1
        },
        "exploit": {
          "description": "成功读取文件",
          "stop_after": [
            "tc_xxe_exploit_002"
          ],
          "success_criteria": [
            "通过XXE读取/etc/passwd"
          ],
          "evidence_required": 1
        },
        "verify": {
          "description": "验证XXE完整能力",
          "stop_after": [
            "tc_xxe_verify_003"
          ],
          "success_criteria": [
            "读取多个系统文件",
            "测试SSRF能力"
          ],
          "evidence_required": 2
        }
      }
    },
    "deserialization": {
      "name": "反序列化",
      "enabled": true,
      "goal": "exploit",
      "goals": {
        "identify": {
          "description": "识别反序列化漏洞",
          "stop_after": [
            "tc_deser_detect_001"
          ],
          "success_criteria": [
            "发现反序列化点和可用gadget"
          ],
          "evidence_required": 1
        },
        "exploit": {
          "description": "成功利用反序列化RCE",
          "stop_after": [
            "tc_deser_exploit_002"
          ],
          "success_criteria": [
            "通过反序列化执行命令"
          ],
          "evidence_required": 1
        },
        "verify": {
          "description": "验证反序列化RCE能力",
          "stop_after": [
            "tc_deser_verify_003"
          ],
          "success_criteria": [
            "执行多个命令",
            "获取系统信息"
          ],
          "evidence_required": 2
        }
      }
    }
  },
  "global_settings": {
    "stop_on_first_success": false,
    "continue_on_failure": true,
    "max_attempts_per_type": 3,
    "evidence_collection": {
      "screenshots": false,
      "command_output": true,
      "network_traffic": false
    }
  },
  "notes": [
    "goal字段定义该漏洞类型的测试目标级别",
    "identify: 识别到漏洞即停止，不进行利用",
    "exploit: 成功利用漏洞即停止",
    "verify: 完整验证漏洞影响范围",
    "当达到配置的goal后，该漏洞类型的测试会停止，继续下一个类型"
  ]
}
